SELECT 
  q1.jname
  , q1.count as num_docs
  , q8.count as pheno_cands
  , to_char(q8.count::float / q1.count::float, '999999999D99') as pheno_cands_per_doc
  , q9.count as pheno_infs
  , to_char(q9.count::float / q1.count::float, '999999999D99') as pheno_infs_per_doc
  FROM
    (SELECT
      a.jname, count(distinct doi)
      FROM
        (SELECT b.id[4] AS jname, b.id[3] AS type, b.id[0:5] AS doi
         FROM (SELECT string_to_array(doc_id, '.') id FROM sentences_input) b) a
      WHERE
        a.type = 'journal'
      GROUP BY
        a.jname
      ORDER BY
        count DESC) q1
    JOIN
    (SELECT
      count(DISTINCT a.docid), a.jname
      FROM
        (SELECT b.id[0:5] AS docid, b.id[3] AS type, b.id[4] as jname 
         FROM (SELECT string_to_array(doc_id, '.') id FROM gene_mentions WHERE is_correct != 'f' OR is_correct IS NULL) b) a
      WHERE
        a.type = 'journal'
      GROUP BY
        a.jname
      ORDER BY
        count DESC) q2
    ON (q1.jname = q2.jname)
    JOIN
    (SELECT
      count(DISTINCT a.docid), a.jname
      FROM
        (SELECT b.id[0:5] AS docid, b.id[3] AS type, b.id[4] as jname 
         FROM (SELECT string_to_array(doc_id, '.') id FROM gene_mentions_is_correct_inference WHERE expectation > 0.9) b) a
      WHERE
        a.type = 'journal'
      GROUP BY
        a.jname
      ORDER BY
        count DESC) q3
    ON (q2.jname = q3.jname)
    JOIN
    (SELECT
      count(DISTINCT a.docid), a.jname
      FROM
        (SELECT b.id[0:5] AS docid, b.id[3] AS type, b.id[4] as jname 
         FROM (SELECT string_to_array(doc_id, '.') id FROM genepheno_association WHERE is_correct != 'f' OR is_correct IS NULL) b) a
      WHERE
        a.type = 'journal'
      GROUP BY
        a.jname
      ORDER BY
        count DESC) q4
    ON (q3.jname = q4.jname)
    JOIN
    (SELECT
      count(DISTINCT a.docid), a.jname
      FROM
        (SELECT b.id[0:5] AS docid, b.id[3] AS type, b.id[4] as jname 
         FROM (SELECT string_to_array(doc_id, '.') id FROM genepheno_causation WHERE is_correct != 'f' OR is_correct IS NULL) b) a
      WHERE
        a.type = 'journal'
      GROUP BY
        a.jname
      ORDER BY
        count DESC) q5
    ON (q4.jname = q5.jname)
    JOIN
    (SELECT
      count(DISTINCT a.docid), a.jname
      FROM
        (SELECT b.id[0:5] AS docid, b.id[3] AS type, b.id[4] as jname 
         FROM (SELECT string_to_array(doc_id, '.') id FROM genepheno_association_is_correct_inference WHERE expectation > 0.9) b) a
      WHERE
        a.type = 'journal'
      GROUP BY
        a.jname
      ORDER BY
        count DESC) q6
    ON (q5.jname = q6.jname)
    JOIN
    (SELECT
      count(DISTINCT a.docid), a.jname
      FROM
        (SELECT b.id[0:5] AS docid, b.id[3] AS type, b.id[4] as jname 
         FROM (SELECT string_to_array(doc_id, '.') id FROM genepheno_causation_is_correct_inference WHERE expectation > 0.9) b) a
      WHERE
        a.type = 'journal'
      GROUP BY
        a.jname
      ORDER BY
        count DESC) q7
    ON (q6.jname = q7.jname)
    JOIN
    (SELECT
      count(DISTINCT a.docid), a.jname
      FROM
        (SELECT b.id[0:5] AS docid, b.id[3] AS type, b.id[4] as jname 
         FROM (SELECT string_to_array(doc_id, '.') id FROM pheno_mentions WHERE is_correct != 'f' OR is_correct IS NULL) b) a
      WHERE
        a.type = 'journal'
      GROUP BY
        a.jname
      ORDER BY
        count DESC) q8
    ON (q7.jname = q8.jname)
    JOIN
    (SELECT
      count(DISTINCT a.docid), a.jname
      FROM
        (SELECT b.id[0:5] AS docid, b.id[3] AS type, b.id[4] as jname 
         FROM (SELECT string_to_array(doc_id, '.') id FROM pheno_mentions_is_correct_inference WHERE expectation > 0.9) b) a
      WHERE
        a.type = 'journal'
      GROUP BY
        a.jname
      ORDER BY
        count DESC) q9
    ON (q8.jname = q9.jname)
