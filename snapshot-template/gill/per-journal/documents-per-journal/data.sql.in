SELECT
  a.jname, count(distinct doi)
  FROM
    (SELECT b.id[4] AS jname, b.id[3] AS type, b.id[0:5] AS doi
     FROM (SELECT string_to_array(doc_id, '.') id FROM sentences_input) b) a
  WHERE
    a.type = 'journal'
  GROUP BY
    a.jname
  ORDER BY
    count DESC
